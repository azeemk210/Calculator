<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime location tracker</title>

    <!-- leaflet css  -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>

<body>
    <div id="map"></div>
</body>
</html>

<!-- leaflet js  -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
    // Map initialization 
    var current_lat = 14.0860746
    var current_long= 100.608406
    var map = L.map('map').setView([current_lat ,current_long ], 6);

    map.locate({setView: true, watch: true})
        .on('locationerror', function(e){
            console.log(e);
            alert("Location access has been denied.");
        });

    //osm layer
    var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });
    osm.addTo(map);

    if(!navigator.geolocation) {
        console.log("Your browser doesn't support geolocation feature!")
    } else {
        setInterval(() => {
            navigator.geolocation.getCurrentPosition(getPosition)
        }, 5000);
    }



    var marker, circle;

    function getPosition(position){
        // console.log(position)
        var current_lat = position.coords.latitude
        var current_long = position.coords.longitude
        var accuracy = position.coords.accuracy

        if(marker) {
            map.removeLayer(marker)
        }

        if(circle) {
            map.removeLayer(circle)
        }

        marker = L.marker([current_lat, current_long])
        circle = L.circle([current_lat, current_long], {radius: accuracy})

        var featureGroup = L.featureGroup([marker, circle]).addTo(map)

        map.fitBounds(featureGroup.getBounds())

        console.log("Your coordinate is: Lat: "+ current_lat +" Long: "+ current_long+ " Accuracy: "+ accuracy)
    }

</script>

<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
		<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

        <div id="map"></div>

<script type="text/javascript">

    function main() {

        var options = {
            center: [40.420488, -3.705878],
            zoom: 12
        }
        
        var map = L.map('map', options);

        L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {attribution: 'CARTO'})
        .addTo(map);

        var customMarker = L.icon({
            iconUrl: 'logo_carto.png',
            iconSize:     [232, 92], 
            iconAnchor:   [40.420488, -3.705878]
        });

        L.marker([40.420488, -3.705878], {icon: customMarker}).addTo(map);

        map.on('click', 
            function(e){
                var coord = e.latlng.toString().split(',');
                var lat = coord[0].split('(');
                var lng = coord[1].split(')');
                console.log("You clicked the map at latitude: " + lat[1] + " and longitude:" + lng[0]);
            });
    }
    window.onload = main;
</script>